# Instale pacotes necessários (caso ainda não estejam instalados)
if (!require(tidyverse)) install.packages("tidyverse")

# Carregar bibliotecas
library(tidyverse)

# 1. Carregar os dados das vacinas por região
# Definindo o caminho do arquivo CSV
caminho_arquivo <- "C:\\Users\\thaiza\\OneDrive\\Área de Trabalho\\R\\CSV\\FAIXA_ETÁRIA_E_IMUNIZAÇÃO.csv"
  
# 2. Resumo dos dados
summary(dados_regiao)

# 3. Realizar a ANOVA para verificar se há diferenças significativas entre as médias das doses nas regiões
anova_result <- aov(Doses ~ Regiao, data = dados_regiao)

# Exibir o resumo da ANOVA
summary(anova_result)

# 4. Teste de Tukey para identificar quais regiões diferem significativamente
tukey_result <- TukeyHSD(anova_result)

# Exibir o resultado do teste de Tukey
print(tukey_result)

# 5. Visualizar os resultados com um gráfico de comparações de Tukey
plot(tukey_result, las = 1)

# 6. Análise exploratória adicional (boxplot)
ggplot(dados_regiao, aes(x = Regiao, y = Doses, fill = Regiao)) +
  geom_boxplot() +
  theme_minimal() +
  labs(title = "Distribuição das Doses Aplicadas por Região", 
       x = "Região", y = "Doses Aplicadas")

Console:

> # Análise de variância (ANOVA)
> anova_result <- aov(Doses ~ Vacina + Faixa_Etaria, data = dados_long)
> summary(anova_result)
              Df    Sum Sq   Mean Sq F value   Pr(>F)    
Vacina         8 8.459e+13 1.057e+13   1.702 0.102755    
Faixa_Etaria  18 3.014e+14 1.674e+13   2.694 0.000569 ***
Residuals    144 8.948e+14 6.214e+12                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> 
> # Comparações de Tukey
> tukey_result <- TukeyHSD(anova_result)
> print(tukey_result)
  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = Doses ~ Vacina + Faixa_Etaria, data = dados_long)

$Vacina
                         diff        lwr       upr     p adj
DT-BCG             -63346.053 -2610640.2 2483948.1 1.0000000
FA-BCG            1166453.895 -1380840.3 3713748.1 0.8793806
HX-BCG             -60241.789 -2607535.9 2487052.4 1.0000000
INF-BCG             66414.000 -2480880.2 2613708.2 1.0000000
MncC-BCG          2094712.947  -452581.2 4642007.1 0.2000794
TETRA-BCG           -4405.105 -2551699.3 2542889.1 1.0000000
Tetraviral-BCG     488028.842 -2059265.3 3035323.0 0.9995684
VIP-BCG             45754.263 -2501539.9 2593048.4 1.0000000
FA-DT             1229799.947 -1317494.2 3777094.1 0.8441761
HX-DT                3104.263 -2544189.9 2550398.4 1.0000000
INF-DT             129760.053 -2417534.1 2677054.2 1.0000000
MncC-DT           2158059.000  -389235.2 4705353.2 0.1687518
TETRA-DT            58940.947 -2488353.2 2606235.1 1.0000000
Tetraviral-DT      551374.895 -1995919.3 3098669.1 0.9989464
VIP-DT             109100.316 -2438193.8 2656394.5 1.0000000
HX-FA            -1226695.684 -3773989.8 1320598.5 0.8460204
INF-FA           -1100039.895 -3647334.1 1447254.3 0.9106632
MncC-FA            928259.053 -1619035.1 3475553.2 0.9656345
TETRA-FA         -1170859.000 -3718153.2 1376435.2 0.8771003
Tetraviral-FA     -678425.053 -3225719.2 1868869.1 0.9954499
VIP-FA           -1120699.632 -3667993.8 1426594.5 0.9015551
INF-HX             126655.789 -2420638.4 2673949.9 1.0000000
MncC-HX           2154954.737  -392339.4 4702248.9 0.1701982
TETRA-HX            55836.684 -2491457.5 2603130.8 1.0000000
Tetraviral-HX      548270.632 -1999023.5 3095564.8 0.9989885
VIP-HX             105996.053 -2441298.1 2653290.2 1.0000000
MncC-INF          2028298.947  -518995.2 4575593.1 0.2370656
TETRA-INF          -70819.105 -2618113.3 2476475.1 1.0000000
Tetraviral-INF     421614.842 -2125679.3 2968909.0 0.9998553
VIP-INF            -20659.737 -2567953.9 2526634.4 1.0000000
TETRA-MncC       -2099118.053 -4646412.2  448176.1 0.1977767
Tetraviral-MncC  -1606684.105 -4153978.3  940610.1 0.5552383
VIP-MncC         -2048958.684 -4596252.8  498335.5 0.2251040
Tetraviral-TETRA   492433.947 -2054860.2 3039728.1 0.9995388
VIP-TETRA           50159.368 -2497134.8 2597453.5 1.0000000
VIP-Tetraviral    -442274.579 -2989568.7 2105019.6 0.9997927

$Faixa_Etaria
                         diff       lwr        upr     p adj
10 anos-1 ano   -5.941840e+06 -10152376 -1731304.2 0.0002009
11 anos-1 ano   -5.670483e+06  -9881018 -1459947.1 0.0005382
12 anos-1 ano   -5.608595e+06  -9819131 -1398059.3 0.0006703
13 anos-1 ano   -5.736707e+06  -9947242 -1526171.1 0.0004247
14 anos-1 ano   -5.938272e+06 -10148807 -1727736.0 0.0002036
15 anos-1 ano   -5.964081e+06 -10174617 -1753545.4 0.0001850
16 anos-1 ano   -5.964096e+06 -10174631 -1753559.9 0.0001850
17 anos-1 ano   -5.964097e+06 -10174633 -1753561.4 0.0001850
18 anos-1 ano   -5.964104e+06 -10174640 -1753568.8 0.0001850
19 anos-1 ano   -5.964104e+06 -10174640 -1753568.5 0.0001850
2 anos-1 ano    -5.425195e+06  -9635731 -1214659.5 0.0012683
3 anos-1 ano    -5.565877e+06  -9776412 -1355340.9 0.0007789
4 anos-1 ano    -4.714344e+06  -8924879  -503808.1 0.0123824
5 anos-1 ano    -5.961924e+06 -10172460 -1751388.2 0.0001865
6 anos-1 ano    -5.962742e+06 -10173277 -1752206.1 0.0001860
7 anos-1 ano    -5.962957e+06 -10173492 -1752420.9 0.0001858
8 anos-1 ano    -5.963006e+06 -10173542 -1752470.8 0.0001858
9 anos-1 ano    -5.943917e+06 -10154453 -1733381.6 0.0001994
11 anos-10 anos  2.713571e+05  -3939179  4481892.8 1.0000000
12 anos-10 anos  3.332449e+05  -3877291  4543780.6 1.0000000
13 anos-10 anos  2.051331e+05  -4005403  4415668.8 1.0000000
14 anos-10 anos  3.568222e+03  -4206967  4214103.9 1.0000000
15 anos-10 anos -2.224122e+04  -4232777  4188294.5 1.0000000
16 anos-10 anos -2.225567e+04  -4232791  4188280.0 1.0000000
17 anos-10 anos -2.225722e+04  -4232793  4188278.5 1.0000000
18 anos-10 anos -2.226456e+04  -4232800  4188271.1 1.0000000
19 anos-10 anos -2.226433e+04  -4232800  4188271.4 1.0000000
2 anos-10 anos   5.166447e+05  -3693891  4727180.4 1.0000000
3 anos-10 anos   3.759633e+05  -3834572  4586499.0 1.0000000
4 anos-10 anos   1.227496e+06  -2983040  5438031.8 0.9999250
5 anos-10 anos  -2.008400e+04  -4230620  4190451.7 1.0000000
6 anos-10 anos  -2.090189e+04  -4231438  4189633.8 1.0000000
7 anos-10 anos  -2.111667e+04  -4231652  4189419.0 1.0000000
8 anos-10 anos  -2.116656e+04  -4231702  4189369.1 1.0000000
9 anos-10 anos  -2.077444e+03  -4212613  4208458.2 1.0000000
12 anos-11 anos  6.188778e+04  -4148648  4272423.5 1.0000000
13 anos-11 anos -6.622400e+04  -4276760  4144311.7 1.0000000
14 anos-11 anos -2.677889e+05  -4478325  3942746.8 1.0000000
15 anos-11 anos -2.935983e+05  -4504134  3916937.4 1.0000000
16 anos-11 anos -2.936128e+05  -4504148  3916922.9 1.0000000
17 anos-11 anos -2.936143e+05  -4504150  3916921.4 1.0000000
18 anos-11 anos -2.936217e+05  -4504157  3916914.0 1.0000000
19 anos-11 anos -2.936214e+05  -4504157  3916914.2 1.0000000
2 anos-11 anos   2.452876e+05  -3965248  4455823.2 1.0000000
3 anos-11 anos   1.046062e+05  -4105929  4315141.9 1.0000000
4 anos-11 anos   9.561390e+05  -3254397  5166674.7 0.9999983
5 anos-11 anos  -2.914411e+05  -4501977  3919094.6 1.0000000
6 anos-11 anos  -2.922590e+05  -4502795  3918276.7 1.0000000
7 anos-11 anos  -2.924738e+05  -4503009  3918061.9 1.0000000
8 anos-11 anos  -2.925237e+05  -4503059  3918012.0 1.0000000
9 anos-11 anos  -2.734346e+05  -4483970  3937101.1 1.0000000
13 anos-12 anos -1.281118e+05  -4338647  4082423.9 1.0000000
14 anos-12 anos -3.296767e+05  -4540212  3880859.0 1.0000000
15 anos-12 anos -3.554861e+05  -4566022  3855049.6 1.0000000
16 anos-12 anos -3.555006e+05  -4566036  3855035.1 1.0000000
17 anos-12 anos -3.555021e+05  -4566038  3855033.6 1.0000000
18 anos-12 anos -3.555094e+05  -4566045  3855026.2 1.0000000
19 anos-12 anos -3.555092e+05  -4566045  3855026.5 1.0000000
2 anos-12 anos   1.833998e+05  -4027136  4393935.5 1.0000000
3 anos-12 anos   4.271844e+04  -4167817  4253254.1 1.0000000
4 anos-12 anos   8.942512e+05  -3316284  5104786.9 0.9999994
5 anos-12 anos  -3.533289e+05  -4563865  3857206.8 1.0000000
6 anos-12 anos  -3.541468e+05  -4564682  3856388.9 1.0000000
7 anos-12 anos  -3.543616e+05  -4564897  3856174.1 1.0000000
8 anos-12 anos  -3.544114e+05  -4564947  3856124.2 1.0000000
9 anos-12 anos  -3.353223e+05  -4545858  3875213.4 1.0000000
14 anos-13 anos -2.015649e+05  -4412101  4008970.8 1.0000000
15 anos-13 anos -2.273743e+05  -4437910  3983161.4 1.0000000
16 anos-13 anos -2.273888e+05  -4437924  3983146.9 1.0000000
17 anos-13 anos -2.273903e+05  -4437926  3983145.4 1.0000000
18 anos-13 anos -2.273977e+05  -4437933  3983138.0 1.0000000
19 anos-13 anos -2.273974e+05  -4437933  3983138.2 1.0000000
2 anos-13 anos   3.115116e+05  -3899024  4522047.2 1.0000000
3 anos-13 anos   1.708302e+05  -4039705  4381365.9 1.0000000
4 anos-13 anos   1.022363e+06  -3188173  5232898.7 0.9999951
5 anos-13 anos  -2.252171e+05  -4435753  3985318.6 1.0000000
6 anos-13 anos  -2.260350e+05  -4436571  3984500.7 1.0000000
7 anos-13 anos  -2.262498e+05  -4436785  3984285.9 1.0000000
8 anos-13 anos  -2.262997e+05  -4436835  3984236.0 1.0000000
9 anos-13 anos  -2.072106e+05  -4417746  4003325.1 1.0000000
15 anos-14 anos -2.580944e+04  -4236345  4184726.2 1.0000000
16 anos-14 anos -2.582389e+04  -4236360  4184711.8 1.0000000
17 anos-14 anos -2.582544e+04  -4236361  4184710.2 1.0000000
18 anos-14 anos -2.583278e+04  -4236368  4184702.9 1.0000000
19 anos-14 anos -2.583256e+04  -4236368  4184703.1 1.0000000
2 anos-14 anos   5.130764e+05  -3697459  4723612.1 1.0000000
3 anos-14 anos   3.723951e+05  -3838141  4582930.8 1.0000000
4 anos-14 anos   1.223928e+06  -2986608  5434463.6 0.9999281
5 anos-14 anos  -2.365222e+04  -4234188  4186883.5 1.0000000
6 anos-14 anos  -2.447011e+04  -4235006  4186065.6 1.0000000
7 anos-14 anos  -2.468489e+04  -4235221  4185850.8 1.0000000
8 anos-14 anos  -2.473478e+04  -4235270  4185800.9 1.0000000
9 anos-14 anos  -5.645667e+03  -4216181  4204890.0 1.0000000
16 anos-15 anos -1.444444e+01  -4210550  4210521.2 1.0000000
17 anos-15 anos -1.600000e+01  -4210552  4210519.7 1.0000000
18 anos-15 anos -2.333333e+01  -4210559  4210512.4 1.0000000
19 anos-15 anos -2.311111e+01  -4210559  4210512.6 1.0000000
2 anos-15 anos   5.388859e+05  -3671650  4749421.6 1.0000000
3 anos-15 anos   3.982046e+05  -3812331  4608740.2 1.0000000
4 anos-15 anos   1.249737e+06  -2960798  5460273.0 0.9999032
5 anos-15 anos   2.157222e+03  -4208378  4212692.9 1.0000000
6 anos-15 anos   1.339333e+03  -4209196  4211875.0 1.0000000
7 anos-15 anos   1.124556e+03  -4209411  4211660.2 1.0000000
8 anos-15 anos   1.074667e+03  -4209461  4211610.4 1.0000000
9 anos-15 anos   2.016378e+04  -4190372  4230699.5 1.0000000
17 anos-16 anos -1.555556e+00  -4210537  4210534.1 1.0000000
18 anos-16 anos -8.888889e+00  -4210545  4210526.8 1.0000000
19 anos-16 anos -8.666667e+00  -4210544  4210527.0 1.0000000
2 anos-16 anos   5.389003e+05  -3671635  4749436.0 1.0000000
3 anos-16 anos   3.982190e+05  -3812317  4608754.7 1.0000000
4 anos-16 anos   1.249752e+06  -2960784  5460287.5 0.9999031
5 anos-16 anos   2.171667e+03  -4208364  4212707.4 1.0000000
6 anos-16 anos   1.353778e+03  -4209182  4211889.5 1.0000000
7 anos-16 anos   1.139000e+03  -4209397  4211674.7 1.0000000
8 anos-16 anos   1.089111e+03  -4209447  4211624.8 1.0000000
9 anos-16 anos   2.017822e+04  -4190357  4230713.9 1.0000000
18 anos-17 anos -7.333333e+00  -4210543  4210528.4 1.0000000
19 anos-17 anos -7.111111e+00  -4210543  4210528.6 1.0000000
2 anos-17 anos   5.389019e+05  -3671634  4749437.6 1.0000000
3 anos-17 anos   3.982206e+05  -3812315  4608756.2 1.0000000
4 anos-17 anos   1.249753e+06  -2960782  5460289.0 0.9999031
5 anos-17 anos   2.173222e+03  -4208362  4212708.9 1.0000000
6 anos-17 anos   1.355333e+03  -4209180  4211891.0 1.0000000
7 anos-17 anos   1.140556e+03  -4209395  4211676.2 1.0000000
8 anos-17 anos   1.090667e+03  -4209445  4211626.4 1.0000000
9 anos-17 anos   2.017978e+04  -4190356  4230715.5 1.0000000
19 anos-18 anos  2.222222e-01  -4210535  4210535.9 1.0000000
2 anos-18 anos   5.389092e+05  -3671626  4749444.9 1.0000000
3 anos-18 anos   3.982279e+05  -3812308  4608763.6 1.0000000
4 anos-18 anos   1.249761e+06  -2960775  5460296.4 0.9999031
5 anos-18 anos   2.180556e+03  -4208355  4212716.2 1.0000000
6 anos-18 anos   1.362667e+03  -4209173  4211898.4 1.0000000
7 anos-18 anos   1.147889e+03  -4209388  4211683.6 1.0000000
8 anos-18 anos   1.098000e+03  -4209438  4211633.7 1.0000000
9 anos-18 anos   2.018711e+04  -4190349  4230722.8 1.0000000
2 anos-19 anos   5.389090e+05  -3671627  4749444.7 1.0000000
3 anos-19 anos   3.982277e+05  -3812308  4608763.4 1.0000000
4 anos-19 anos   1.249760e+06  -2960775  5460296.1 0.9999031
5 anos-19 anos   2.180333e+03  -4208355  4212716.0 1.0000000
6 anos-19 anos   1.362444e+03  -4209173  4211898.1 1.0000000
7 anos-19 anos   1.147667e+03  -4209388  4211683.4 1.0000000
8 anos-19 anos   1.097778e+03  -4209438  4211633.5 1.0000000
9 anos-19 anos   2.018689e+04  -4190349  4230722.6 1.0000000
3 anos-2 anos   -1.406813e+05  -4351217  4069854.4 1.0000000
4 anos-2 anos    7.108514e+05  -3499684  4921387.1 1.0000000
5 anos-2 anos   -5.367287e+05  -4747264  3673807.0 1.0000000
6 anos-2 anos   -5.375466e+05  -4748082  3672989.1 1.0000000
7 anos-2 anos   -5.377613e+05  -4748297  3672774.4 1.0000000
8 anos-2 anos   -5.378112e+05  -4748347  3672724.5 1.0000000
9 anos-2 anos   -5.187221e+05  -4729258  3691813.6 1.0000000
4 anos-3 anos    8.515328e+05  -3359003  5062068.5 0.9999997
5 anos-3 anos   -3.960473e+05  -4606583  3814488.4 1.0000000
6 anos-3 anos   -3.968652e+05  -4607401  3813670.5 1.0000000
7 anos-3 anos   -3.970800e+05  -4607616  3813455.7 1.0000000
8 anos-3 anos   -3.971299e+05  -4607666  3813405.8 1.0000000
9 anos-3 anos   -3.780408e+05  -4588576  3832494.9 1.0000000
5 anos-4 anos   -1.247580e+06  -5458116  2962955.6 0.9999055
6 anos-4 anos   -1.248398e+06  -5458934  2962137.7 0.9999046
7 anos-4 anos   -1.248613e+06  -5459148  2961922.9 0.9999044
8 anos-4 anos   -1.248663e+06  -5459198  2961873.0 0.9999043
9 anos-4 anos   -1.229574e+06  -5440109  2980962.1 0.9999232
6 anos-5 anos   -8.178889e+02  -4211354  4209717.8 1.0000000
7 anos-5 anos   -1.032667e+03  -4211568  4209503.0 1.0000000
8 anos-5 anos   -1.082556e+03  -4211618  4209453.1 1.0000000
9 anos-5 anos    1.800656e+04  -4192529  4228542.2 1.0000000
7 anos-6 anos   -2.147778e+02  -4210750  4210320.9 1.0000000
8 anos-6 anos   -2.646667e+02  -4210800  4210271.0 1.0000000
9 anos-6 anos    1.882444e+04  -4191711  4229360.1 1.0000000
8 anos-7 anos   -4.988889e+01  -4210586  4210485.8 1.0000000
9 anos-7 anos    1.903922e+04  -4191496  4229574.9 1.0000000
9 anos-8 anos    1.908911e+04  -4191447  4229624.8 1.0000000

> 
> # Visualização das comparações de Tukey
> plot(tukey_result)
> 
> # Visualização dos resultados
> ggplot(dados_long, aes(x = Vacina, y = Doses, fill = Faixa_Etaria)) +
+   geom_bar(stat = "identity", position = "dodge") +
+   theme_minimal() +
+   labs(title = "Doses Aplicadas por Faixa Etária e Vacina", x = "Vacina", y = "Número de Doses")
