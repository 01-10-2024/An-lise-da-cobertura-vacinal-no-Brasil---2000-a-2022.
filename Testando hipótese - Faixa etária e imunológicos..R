#Testando hip?tese - Faixa et?ria e imunol?gicos.

# Pacotes necess?rios 
if (!require(tidyverse)) install.packages("tidyverse")
if (!require(agricolae)) install.packages("agricolae")

# Carregar pacotes
library(tidyverse)
library(agricolae)

# Criar os dados no formato longo
dados <- data.frame(
  faixa_etaria = rep(1:19, each = 11),  # Faixas et?rias

  # Carregar os dados de vacina??o
  dados_vacinacao <- read.csv("C:\\Users\\thaiza\\OneDrive\\?rea de Trabalho\\R\\FAIXA_ETÁRIA_E_IMUNOL?GICOS.csv", sep = ";", header = TRUE)
  
# Converter vari?veis para fator
dados$faixa_etaria <- as.factor(dados$faixa_etaria)
dados$vacina <- as.factor(dados$vacina)

# Estat?sticas descritivas
summary_stats <- dados %>%
  group_by(vacina) %>%
  summarise(
    Length = n(),
    Min = min(doses),
    `1st Qu.` = quantile(doses, 0.25),
    Median = median(doses),
    Mean = mean(doses),
    `3rd Qu.` = quantile(doses, 0.75),
    Max = max(doses)
  )

print(summary_stats)

# ANOVA
anova_result <- aov(doses ~ faixa_etaria + vacina, data = dados)
summary(anova_result)

# Teste de Tukey
tukey_result <- TukeyHSD(anova_result, "faixa_etaria")
print(tukey_result)

# Plotar o teste de Tukey
plot(tukey_result, las = 2)

Console:

> print(summary_stats)
# A tibble: 11 × 8
   vacina      Length   Min `1st Qu.` Median     Mean `3rd Qu.`      Max
   <fct>        <int> <dbl>     <dbl>  <dbl>    <dbl>     <dbl>    <dbl>
 1 BCG             19     0         0      0   64244.        0    628630
 2 DT              19     0         0      0     898.        0     10395
 3 FA              19     0      3898   9282 1230697.    11292. 10006927
 4 Hepatite_AB     19     0         0      0     437.        0      5518
 5 HPV             19     0         0    260    6297.     3101     33400
 6 HX              19     0         0      0    4002.        0     65425
 7 INF             19     0         0      0  130658.        0   1044713
 8 MncC            19     0      1072 135740 2158957.   324994. 31945137
 9 TETRA           19     0         0      0   59838.        0    863198
10 Tetraviral      19     0         0      0  545975.        0   9756227
11 VIP             19     0         0      0  109998.     1528.  1383168
> 
> # ANOVA
> anova_result <- aov(doses ~ faixa_etaria + vacina, data = dados)
> summary(anova_result)
              Df    Sum Sq   Mean Sq F value   Pr(>F)    
faixa_etaria  18 2.466e+14 1.370e+13   2.597 0.000713 ***
vacina        10 9.159e+13 9.159e+12   1.736 0.075809 .  
Residuals    180 9.497e+14 5.276e+12                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> 
> # Teste de Tukey
> tukey_result <- TukeyHSD(anova_result, "faixa_etaria")
> print(tukey_result)
  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = doses ~ faixa_etaria + vacina, data = dados)

$faixa_etaria
               diff      lwr        upr     p adj
2-1   -4.439189e+06 -7935618  -942760.6 0.0015704
3-1   -4.554350e+06 -8050779 -1057921.5 0.0009673
4-1   -3.857598e+06 -7354027  -361169.2 0.0149236
5-1   -4.878439e+06 -8374868 -1382010.5 0.0002327
6-1   -4.879109e+06 -8375537 -1382679.6 0.0002320
7-1   -4.879284e+06 -8375713 -1382855.4 0.0002318
8-1   -4.879325e+06 -8375754 -1382896.2 0.0002317
9-1   -4.863707e+06 -8360136 -1367277.8 0.0002487
10-1  -4.862007e+06 -8358436 -1365578.1 0.0002506
11-1  -4.639988e+06 -8136416 -1143558.6 0.0006695
12-1  -4.589352e+06 -8085781 -1092923.2 0.0008328
13-1  -4.694171e+06 -8190600 -1197741.9 0.0005287
14-1  -4.859088e+06 -8355516 -1362658.6 0.0002539
15-1  -4.880204e+06 -8376633 -1383775.5 0.0002308
16-1  -4.880216e+06 -8376645 -1383787.3 0.0002308
17-1  -4.880217e+06 -8376646 -1383788.6 0.0002308
18-1  -4.880223e+06 -8376652 -1383794.6 0.0002308
19-1  -4.880223e+06 -8376652 -1383794.4 0.0002308
3-2   -1.151609e+05 -3611590  3381268.0 1.0000000
4-2    5.815914e+05 -2914838  4078020.3 1.0000000
5-2   -4.392499e+05 -3935679  3057179.0 1.0000000
6-2   -4.399191e+05 -3936348  3056509.8 1.0000000
7-2   -4.400948e+05 -3936524  3056334.1 1.0000000
8-2   -4.401356e+05 -3936565  3056293.3 1.0000000
9-2   -4.245173e+05 -3920946  3071911.6 1.0000000
10-2  -4.228175e+05 -3919246  3073611.4 1.0000000
11-2  -2.007981e+05 -3697227  3295630.8 1.0000000
12-2  -1.501626e+05 -3646592  3346266.3 1.0000000
13-2  -2.549814e+05 -3751410  3241447.5 1.0000000
14-2  -4.198981e+05 -3916327  3076530.8 1.0000000
15-2  -4.410149e+05 -3937444  3055414.0 1.0000000
16-2  -4.410267e+05 -3937456  3055402.2 1.0000000
17-2  -4.410280e+05 -3937457  3055400.9 1.0000000
18-2  -4.410340e+05 -3937463  3055394.9 1.0000000
19-2  -4.410338e+05 -3937463  3055395.1 1.0000000
4-3    6.967523e+05 -2799677  4193181.2 0.9999998
5-3   -3.240890e+05 -3820518  3172339.9 1.0000000
6-3   -3.247582e+05 -3821187  3171670.7 1.0000000
7-3   -3.249339e+05 -3821363  3171495.0 1.0000000
8-3   -3.249747e+05 -3821404  3171454.2 1.0000000
9-3   -3.093564e+05 -3805785  3187072.5 1.0000000
10-3  -3.076566e+05 -3804086  3188772.3 1.0000000
11-3  -8.563718e+04 -3582066  3410791.7 1.0000000
12-3  -3.500173e+04 -3531431  3461427.2 1.0000000
13-3  -1.398205e+05 -3636249  3356608.4 1.0000000
14-3  -3.047372e+05 -3801166  3191691.7 1.0000000
15-3  -3.258540e+05 -3822283  3170574.9 1.0000000
16-3  -3.258658e+05 -3822295  3170563.1 1.0000000
17-3  -3.258671e+05 -3822296  3170561.8 1.0000000
18-3  -3.258731e+05 -3822302  3170555.8 1.0000000
19-3  -3.258729e+05 -3822302  3170556.0 1.0000000
5-4   -1.020841e+06 -4517270  2475587.6 0.9999314
6-4   -1.021510e+06 -4517939  2474918.4 0.9999307
7-4   -1.021686e+06 -4518115  2474742.7 0.9999305
8-4   -1.021727e+06 -4518156  2474701.9 0.9999305
9-4   -1.006109e+06 -4502538  2490320.3 0.9999444
10-4  -1.004409e+06 -4500838  2492020.0 0.9999457
11-4  -7.823895e+05 -4278818  2714039.4 0.9999988
12-4  -7.317540e+05 -4228183  2764674.9 0.9999996
13-4  -8.365727e+05 -4333002  2659856.2 0.9999965
14-4  -1.001489e+06 -4497918  2494939.4 0.9999480
15-4  -1.022606e+06 -4519035  2473822.6 0.9999296
16-4  -1.022618e+06 -4519047  2473810.8 0.9999296
17-4  -1.022619e+06 -4519048  2473809.5 0.9999296
18-4  -1.022625e+06 -4519054  2473803.5 0.9999296
19-4  -1.022625e+06 -4519054  2473803.7 0.9999296
6-5   -6.691818e+02 -3497098  3495759.7 1.0000000
7-5   -8.449091e+02 -3497274  3495584.0 1.0000000
8-5   -8.857273e+02 -3497315  3495543.2 1.0000000
9-5    1.473264e+04 -3481696  3511161.5 1.0000000
10-5   1.643236e+04 -3479997  3512861.3 1.0000000
11-5   2.384518e+05 -3257977  3734880.7 1.0000000
12-5   2.890873e+05 -3207342  3785516.2 1.0000000
13-5   1.842685e+05 -3312160  3680697.4 1.0000000
14-5   1.935182e+04 -3477077  3515780.7 1.0000000
15-5  -1.765000e+03 -3498194  3494663.9 1.0000000
16-5  -1.776818e+03 -3498206  3494652.1 1.0000000
17-5  -1.778091e+03 -3498207  3494650.8 1.0000000
18-5  -1.784091e+03 -3498213  3494644.8 1.0000000
19-5  -1.783909e+03 -3498213  3494645.0 1.0000000
7-6   -1.757273e+02 -3496605  3496253.2 1.0000000
8-6   -2.165455e+02 -3496645  3496212.4 1.0000000
9-6    1.540182e+04 -3481027  3511830.7 1.0000000
10-6   1.710155e+04 -3479327  3513530.4 1.0000000
11-6   2.391210e+05 -3257308  3735549.9 1.0000000
12-6   2.897565e+05 -3206672  3786185.4 1.0000000
13-6   1.849377e+05 -3311491  3681366.6 1.0000000
14-6   2.002100e+04 -3476408  3516449.9 1.0000000
15-6  -1.095818e+03 -3497525  3495333.1 1.0000000
16-6  -1.107636e+03 -3497537  3495321.3 1.0000000
17-6  -1.108909e+03 -3497538  3495320.0 1.0000000
18-6  -1.114909e+03 -3497544  3495314.0 1.0000000
19-6  -1.114727e+03 -3497544  3495314.2 1.0000000
8-7   -4.081818e+01 -3496470  3496388.1 1.0000000
9-7    1.557755e+04 -3480851  3512006.4 1.0000000
10-7   1.727727e+04 -3479152  3513706.2 1.0000000
11-7   2.392967e+05 -3257132  3735725.6 1.0000000
12-7   2.899322e+05 -3206497  3786361.1 1.0000000
13-7   1.851135e+05 -3311315  3681542.4 1.0000000
14-7   2.019673e+04 -3476232  3516625.6 1.0000000
15-7  -9.200909e+02 -3497349  3495508.8 1.0000000
16-7  -9.319091e+02 -3497361  3495497.0 1.0000000
17-7  -9.331818e+02 -3497362  3495495.7 1.0000000
18-7  -9.391818e+02 -3497368  3495489.7 1.0000000
19-7  -9.390000e+02 -3497368  3495489.9 1.0000000
9-8    1.561836e+04 -3480811  3512047.3 1.0000000
10-8   1.731809e+04 -3479111  3513747.0 1.0000000
11-8   2.393375e+05 -3257091  3735766.4 1.0000000
12-8   2.899730e+05 -3206456  3786401.9 1.0000000
13-8   1.851543e+05 -3311275  3681583.2 1.0000000
14-8   2.023755e+04 -3476191  3516666.4 1.0000000
15-8  -8.792727e+02 -3497308  3495549.6 1.0000000
16-8  -8.910909e+02 -3497320  3495537.8 1.0000000
17-8  -8.923636e+02 -3497321  3495536.5 1.0000000
18-8  -8.983636e+02 -3497327  3495530.5 1.0000000
19-8  -8.981818e+02 -3497327  3495530.7 1.0000000
10-9   1.699727e+03 -3494729  3498128.6 1.0000000
11-9   2.237192e+05 -3272710  3720148.1 1.0000000
12-9   2.743546e+05 -3222074  3770783.5 1.0000000
13-9   1.695359e+05 -3326893  3665964.8 1.0000000
14-9   4.619182e+03 -3491810  3501048.1 1.0000000
15-9  -1.649764e+04 -3512927  3479931.3 1.0000000
16-9  -1.650945e+04 -3512938  3479919.4 1.0000000
17-9  -1.651073e+04 -3512940  3479918.2 1.0000000
18-9  -1.651673e+04 -3512946  3479912.2 1.0000000
19-9  -1.651655e+04 -3512945  3479912.4 1.0000000
11-10  2.220195e+05 -3274409  3718448.4 1.0000000
12-10  2.726549e+05 -3223774  3769083.8 1.0000000
13-10  1.678362e+05 -3328593  3664265.1 1.0000000
14-10  2.919455e+03 -3493509  3499348.4 1.0000000
15-10 -1.819736e+04 -3514626  3478231.5 1.0000000
16-10 -1.820918e+04 -3514638  3478219.7 1.0000000
17-10 -1.821045e+04 -3514639  3478218.4 1.0000000
18-10 -1.821645e+04 -3514645  3478212.4 1.0000000
19-10 -1.821627e+04 -3514645  3478212.6 1.0000000
12-11  5.063545e+04 -3445793  3547064.4 1.0000000
13-11 -5.418327e+04 -3550612  3442245.6 1.0000000
14-11 -2.191000e+05 -3715529  3277328.9 1.0000000
15-11 -2.402168e+05 -3736646  3256212.1 1.0000000
16-11 -2.402286e+05 -3736658  3256200.3 1.0000000
17-11 -2.402299e+05 -3736659  3256199.0 1.0000000
18-11 -2.402359e+05 -3736665  3256193.0 1.0000000
19-11 -2.402357e+05 -3736665  3256193.2 1.0000000
13-12 -1.048187e+05 -3601248  3391610.2 1.0000000
14-12 -2.697355e+05 -3766164  3226693.4 1.0000000
15-12 -2.908523e+05 -3787281  3205576.6 1.0000000
16-12 -2.908641e+05 -3787293  3205564.8 1.0000000
17-12 -2.908654e+05 -3787294  3205563.5 1.0000000
18-12 -2.908714e+05 -3787300  3205557.5 1.0000000
19-12 -2.908712e+05 -3787300  3205557.7 1.0000000
14-13 -1.649167e+05 -3661346  3331512.2 1.0000000
15-13 -1.860335e+05 -3682462  3310395.4 1.0000000
16-13 -1.860454e+05 -3682474  3310383.5 1.0000000
17-13 -1.860466e+05 -3682476  3310382.3 1.0000000
18-13 -1.860526e+05 -3682482  3310376.3 1.0000000
19-13 -1.860525e+05 -3682481  3310376.4 1.0000000
15-14 -2.111682e+04 -3517546  3475312.1 1.0000000
16-14 -2.112864e+04 -3517558  3475300.3 1.0000000
17-14 -2.112991e+04 -3517559  3475299.0 1.0000000
18-14 -2.113591e+04 -3517565  3475293.0 1.0000000
19-14 -2.113573e+04 -3517565  3475293.2 1.0000000
16-15 -1.181818e+01 -3496441  3496417.1 1.0000000
17-15 -1.309091e+01 -3496442  3496415.8 1.0000000
18-15 -1.909091e+01 -3496448  3496409.8 1.0000000
19-15 -1.890909e+01 -3496448  3496410.0 1.0000000
17-16 -1.272727e+00 -3496430  3496427.6 1.0000000
18-16 -7.272727e+00 -3496436  3496421.6 1.0000000
19-16 -7.090909e+00 -3496436  3496421.8 1.0000000
18-17 -6.000000e+00 -3496435  3496422.9 1.0000000
19-17 -5.818182e+00 -3496435  3496423.1 1.0000000
19-18  1.818182e-01 -3496429  3496429.1 1.0000000

> 
> # Plotar o teste de Tukey
> plot(tukey_result, las = 2)
